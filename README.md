# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемые в приложении

Карточка товара

```
interface ICardProduct {
	id: number;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}
```

Тип данных метода оплаты

```
type TPaymentMethod = 'cash' | 'card';
```

Интерфейс заказа

```
interface IOrder {
	payment: TPaymentMethod;
	email: string;
	phone: string;
	address: string;
	total: number;
	items: string[];
}
```

Данные для отображения модели корзины

```
interface IBasket {
	items: string[];
	total: number;
}
```

Основные данные заказа

```
type TOrderInfo = Pick<
	IOrder,
	'payment' | 'email' | 'phone' | 'address'
>;
```

Данные для форм оформления заказа. Отделение адресных данных и контактных

```
type TOrderAddress = Pick<IOrder, 'payment' | 'address'>;

type TOrderContacts = Pick<IOrder, 'email' | 'phone'>;
```

Тип, описывающий ошибки валидации форм
```
type FormErrors = Partial<Record<keyof TOrderInfo, string>>;
```

Интерфейс для отображения успешного оформления заказа
```
interface ISuccess {
	id: string;
	total: number;
}
```
## Архитектура приложения

В этом проекте применяется паттерн MVP.

Преимущества данного подхода:

- Четкость в движении данных  

- Простота внедрения новых функций  

- Единое управление состоянием приложения  

- Низкая зависимость между компонентами

- Эта архитектура способствует гибкости, масштабируемости и легкости сопровождения приложения.

 Код организован по слоям:

- Слой модели (Model)
Данный уровень отвечает за реализацию бизнес-логики, хранение состояния приложения и управление данными.
Сюда входят файлы api.ts, AppData.ts, LarekApi.ts.
Они обеспечивают обработку данных и интеграцию с API.

- Слой представления (View)
Этот уровень занимается визуализацией данных и сбором пользовательского ввода, исключая бизнес-логику.
К нему относятся файлы Basket.ts, Form.ts, Modal.ts, Success.ts, Card.ts, Page.ts.
Все они представляют собой классы, унаследованные от ViewComponent.

- Слой презентера (Presenter)
Этот слой координирует логику отображения и связь между View и Model.
К нему относятся events.ts, Component.ts, ViewComponent.ts, Contacts.ts, Order.ts.
Эти файлы включают обработчики событий и объединяют View с Model.

### Описание базовых классов

#### Класс Api

Класс Api служит для общения с сервером через HTTP-запросы. Он облегчает отправку запросов и обработку ответов, скрывая детали работы с fetch.  

**Основные методы**:

- get - GET-запрос
- post - POST/PUT/DELETE запросы
- handleResponse - Обработка ответа сервера

#### Класс EventEmitter

Класс управления событиями приложения.

 **Основные методы**:

- on - Подписка на событие
- off - Отписка от события
- emit - Генерация события

#### Класс Component

Component — это основа для всех визуальных компонентов. 

- Принимает контейнер DOM-элемента
- Имеет общие методы для работы с DOM
- Показа/скрытия элементов
- Базовый метод render для обновления состояния

Методы:
- toggleClass() – переключает класс у элемента.  
- setText() – задаёт текст внутри элемента.  
- setDisabled() – активирует или деактивирует состояние disabled у элемента.  
- setHidden() – прячет элемент (display: none).  
- setVisible() – отображает скрытый элемент.  
- setImage() – задаёт src и alt для изображений.  
- render() – обновляет данные компонента (T) и возвращает корневой элемент.

#### Класс ViewComponent

 Это обобщённый класс, расширяющий Component и обеспечивающий интерфейс для работы с UI-элементами. Он поддерживает механизм событий через интерфейс IEvents.  
- container: HTMLElement — HTML-элемент, служащий контейнером для данного UI-компонента.  

- events: IEvents (protected, readonly) — система обработки событий, доступная для использования в наследниках.

### Общие компоненты

#### Класс Form

Form — это универсальный UI-компонент формы, который управляет вводом данных, проверкой их корректности и показом ошибок.

Методы:
- onInputChange - Генерирует событие об изменении значения в поле формы.  
- set valid - Активирует/деактивирует кнопку отправки в зависимости от корректности формы.  
- set errors - Показывает сообщения об ошибках.  
- render - Обновляет состояние формы, включая её валидность и ошибки.

#### Класс Modal

Modal — это UI-компонент, представляющий модальное окно. Он отвечает за управление модальными окнами.

Методы:
- set content - Задаёт содержимое модального окна.  
- open() - Открывает модальное окно и отправляет событие modal:open.  
- close() - Закрывает модальное окно, очищает его содержимое и отправляет событие modal:close.  
- render - Показывает модальное окно с переданными данными.

### Остальные классы

#### Класс Basket

Basket — это UI-компонент, отображающий корзину товаров. 

Защищённые свойства
- _list - Список товаров
- _total - Общая сумма
- _button - Кнопка "Оформить заказ"

Методы:
- toggleButton - Включает или выключает кнопку оформления заказа.  
- set items - Обновляет список товаров в корзине. Если корзина пуста, показывает сообщение.  
- set total - Задаёт общую сумму заказа.

#### Класс Success

Success — это UI-компонент, отвечающий за отображение успешного завершения заказа. 
Защищённые свойства
- _close - Кнопка закрытия
- _total - Текст с информацией о списанной сумме

Методы
- set total - Задаёт сумму списанных синапсов.


#### Класс AppData

Управляет данными приложения: товары, просмотр, корзина, заказы и валидация форм.
Конструктор: constructor(protected events: IEvents)
Методы:

- setItems — обновляет список товаров
- setPreview — устанавливает товар для просмотра
- isInBasket — проверяет наличие товара в корзине
- removeFromBasket — удаляет товар из корзины
- clearBasket — очищает корзину
- setPayment — выбирает способ оплаты
- setOrderField — изменяет данные заказа
- validateOrderForm — проверяет форму заказа
- validateContactsForm — проверяет контакты
- clearOrder — сбрасывает заказ

#### Класс Card

Управляет карточками товаров.
Конструктор: constructor(container: HTMLElement, actions?: ICardActions)
Свойства:

- id — get/set ID карточки
- title — get/set заголовок
- price — get/set цену
- category — get/set категорию
- image — set изображение
- description — set описание
- button — set текст кнопки

#### Класс Contacts

Управляет формой контактов 
Конструктор: constructor(container: HTMLFormElement, events: IEvents)
Методы:

- email — set email
- phone — set телефон

#### Класс Order

Управляет формой заказа 
Конструктор: constructor(container: HTMLFormElement, events: IEvents)
Методы:

- payment — set способ оплаты
- address — set адрес

#### Класс Page

Управляет элементами страницы 
Конструктор: constructor(container: HTMLFormElement, events: IEvents)
Методы:

- counter — set счётчик товаров
- catalog — set обновляет каталог
- locked — set блокирует страницу

#### Класс LarekAPI

Обеспечивает работу с API магазина.
Конструктор: constructor(cdn: string, baseUrl: string, options?: RequestInit)
Методы:

- getProductList — получает список товаров
- getProduct — получает данные товара
- createOrder — создаёт заказ